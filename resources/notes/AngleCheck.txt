To get the AngleXZ of a player

This is what I tried to get from the SAC-Rewrite.

1) Get the direction vector of the player, and make the y property 0, then normalize [playerFacingDirectionXZ]
2) Get the entity position cloned and make the y property 0 [damagedPositionXZ]
3) Do the same for number 2 but with the player [playerPositionXZ]
4) Subtract the damagedPositionXZ by the playerPositionXZ and then normalize it [directionToTargetXZ]
5) dot the playerFacingDirectionXZ by the directionToTargetXZ [directionDotProductXZ]
6) Do the following: rad2deg(acos([directionDotProductXZ]))